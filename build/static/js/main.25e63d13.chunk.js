(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{41:function(e,t,a){e.exports=a(89)},46:function(e,t,a){},89:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(35),o=a.n(c),s=(a(46),a(5)),l=a(12),i=a(17),u=a(10),m=a(2);var d=function(e,t,a){var r=Object(n.useState)(e),c=Object(m.a)(r,2),o=c[0],s=c[1],l=Object(n.useState)({}),d=Object(m.a)(l,2),p=d[0],h=d[1],f=Object(n.useState)(!1),b=Object(m.a)(f,2),v=b[0],E=b[1];return Object(n.useEffect)(function(){v&&(0===Object.keys(p).length?(console.log("use effect no errors"),a(),E(!1)):E(!1))},[p]),{handleChange:function(e){e.persist(),s(function(t){return Object(u.a)({},t,Object(i.a)({},e.target.name,e.target.value))})},handleSubmit:function(e){e.preventDefault();var a=t(o);h(a),E(!0)},handleBlur:function(){var e=t(o);h(e)},values:o,errors:p,isSubmitting:v}};function p(e){var t={};return e.description?e.description.length<10&&(t.description="Description must be at least 10 characters"):t.description="Description required",e.url?/^(ftp|http|https):\/\/[^ "]+$/.test(e.url)||(t.url="Url must be valid"):t.url="Url required",t}var h=Object(n.createContext)(null),f={description:"",url:""};var b=function(e){var t=Object(n.useContext)(h),a=t.firebase,c=t.user,o=d(f,p,function(){if(c){var t={url:i.url,description:i.description,postedBy:{id:c.uid,name:c.displayName},votes:[],comments:[],created:Date.now()};a.db.collection("links").add(t),e.history.push("/")}else e.history.push("/login")}),s=o.handleSubmit,l=o.handleChange,i=o.values,u=o.errors;return r.a.createElement("form",{onSubmit:s,className:"flex flex-column mt3"},r.a.createElement("input",{type:"text",value:i.description,onChange:l,name:"description",placeholder:"A description of your link",autoComplete:"nope",className:u.description&&"error-input"}),u.description&&r.a.createElement("p",{className:"error-text"},u.description),r.a.createElement("input",{type:"url",value:i.url,onChange:l,name:"url",placeholder:"The url of the link",autoComplete:"nope",className:u.url&&"error-input"}),u.url&&r.a.createElement("p",{className:"error-text"},u.url),r.a.createElement("button",{className:"button",type:"submit"},"Submit"))},v=a(19),E=5;var g=a(18),w=a.n(g),O=a(4),j=a.n(O),y=a(11),k=a(36),N=a(37),x=a(20),C=a.n(x),S=(a(62),a(64),{apiKey:"AIzaSyC_R23iLDYCmmVriQIJ9MEiwYN1ei2Eqbs",authDomain:"hacker-news-123.firebaseapp.com",databaseURL:"https://hacker-news-123.firebaseio.com",projectId:"hacker-news-123",storageBucket:"hacker-news-123.appspot.com",messagingSenderId:"491339062042",appId:"1:491339062042:web:89ce554563ec431e192aa3"}),B=new(function(){function e(){Object(k.a)(this,e),C.a.initializeApp(S),this.auth=C.a.auth(),this.db=C.a.firestore()}return Object(N.a)(e,[{key:"register",value:function(){var e=Object(y.a)(j.a.mark(function e(t,a,n){var r;return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.auth.createUserWithEmailAndPassword(a,n);case 2:return r=e.sent,e.next=5,r.user.updateProfile({displayName:t});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"login",value:function(){var e=Object(y.a)(j.a.mark(function e(t,a){return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.auth.signInWithEmailAndPassword(t,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(y.a)(j.a.mark(function e(){return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.auth.signOut();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"resetPassword",value:function(){var e=Object(y.a)(j.a.mark(function e(t){return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.auth.sendPasswordResetEmail(t);case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),e}());var A=Object(l.g)(function(e){var t=e.link,a=e.index,c=e.showCount,o=e.history,l=Object(n.useContext)(h),i=l.firebase,u=l.user,m=u&&u.uid===t.postedBy.id;return r.a.createElement("div",{className:"flex items-start mt2"},r.a.createElement("div",{className:"flex items-center"},c&&r.a.createElement("span",{className:"grey"},a,"."),r.a.createElement("div",{style:{cursor:"pointer"},className:"vote-button",onClick:function(){if(u){var e=i.db.collection("links").doc(t.id);e.get().then(function(t){if(t.exists){var a=t.data().votes,n={votedBy:{id:u.uid,name:u.displayName}},r=[].concat(Object(v.a)(a),[n]),c=r.length;e.update({votes:r,voteCount:c})}})}else o.push("/login")}},"\u25b2")),r.a.createElement("div",{className:"ml1"},r.a.createElement("div",null,r.a.createElement("a",{href:t.url,className:"black no-underline"},t.description," "),r.a.createElement("span",{style:{fontStyle:"italic",color:"orange"},className:"link"},"(",t.url.replace(/^https?:\/\//i,""),")")),r.a.createElement("div",{className:"f6 lh-copy gray"},t.voteCount," votes by ",t.postedBy.name," ",w()(t.created)," | ",r.a.createElement(s.b,{to:"/link/".concat(t.id)},t.comments.length>0?"".concat(t.comments.length," comments"):"discuss"),m&&r.a.createElement(r.a.Fragment,null," | ",r.a.createElement("span",{className:"delete-button",onClick:function(){i.db.collection("links").doc(t.id).delete().then(function(){console.log("document with id: ".concat(t.id," deleted"))}).catch(function(e){console.error("error deleting document:",e)})}},"delete")))))}),P=a(40),I=a.n(P);var D=function(e){var t=Object(n.useContext)(h).firebase,a=Object(n.useState)([]),c=Object(m.a)(a,2),o=c[0],s=c[1],l=Object(n.useState)(null),i=Object(m.a)(l,2),d=i[0],p=i[1],f=Object(n.useState)(!1),b=Object(m.a)(f,2),v=b[0],g=b[1],w=e.location.pathname.includes("new"),O=e.location.pathname.includes("top"),j=Number(e.match.params.page),y=t.db.collection("links"),k=function(e){var t=e.docs.map(function(e){return Object(u.a)({id:e.id},e.data())});s(t);var a=t[t.length-1];p(a),g(!1)};Object(n.useEffect)(function(){var e=function(){g(!0);var e=Boolean(d);if(O)return y.orderBy("voteCount","desc").limit(E).onSnapshot(k);if(1===j)return y.orderBy("created","desc").limit(E).onSnapshot(k);if(e)return y.orderBy("created","desc").startAfter(d.created).limit(E).onSnapshot(k);var t=j*E-E;return I.a.get("https://us-central1-hacker-news-123.cloudfunctions.net/linksPagination?offset=".concat(t)).then(function(e){var t=e.data,a=t[t.length-1];s(t),p(a),g(!1)}),function(){}}();return function(){return e()}},[O,j]);var N=j?(j-1)*E+1:0;return r.a.createElement("div",{style:{opacity:v?.25:1}},o.map(function(e,t){return r.a.createElement(A,{key:e.id,showCount:!0,link:e,index:t+N})}),w&&r.a.createElement("div",{className:"pagination"},r.a.createElement("div",{className:"pointer mr2",onClick:function(){j>1&&e.history.push("/new/".concat(j-1))}},"Previous"),r.a.createElement("div",{className:"pointer",onClick:function(){E/o.length===1&&e.history.push("/new/".concat(j+1))}},"Next")))};var L=function(e){var t=Object(n.useState)(null),a=Object(m.a)(t,2),c=a[0],o=a[1],s=Object(n.useContext)(h),l=s.firebase,i=s.user,d=Object(n.useState)(""),p=Object(m.a)(d,2),f=p[0],b=p[1],E=e.match.params.linkId,g=l.db.collection("links").doc(E);Object(n.useEffect)(function(){O()},[]);var O=function(){g.get().then(function(e){o(Object(u.a)({},e.data(),{id:e.id}))})};return c?r.a.createElement("div",null,r.a.createElement(A,{showCount:!1,link:c}),r.a.createElement("textarea",{onChange:function(e){return b(e.target.value)},value:f,cols:"60",rows:"6"}),r.a.createElement("div",null,r.a.createElement("button",{className:"button",onClick:function(){i?g.get().then(function(e){if(e.exists){var t=e.data().comments,a={postedBy:{id:i.uid,name:i.displayName},created:Date.now(),text:f},n=[].concat(Object(v.a)(t),[a]);g.update({comments:n}),o(function(e){return Object(u.a)({},e,{comments:n})}),b("")}}):e.history.push("/login")}},"Add comment")),c.comments.map(function(e,t){return r.a.createElement("div",{key:t},r.a.createElement("p",{className:"comment-author"},e.postedBy.name," | ",w()(e.created)),r.a.createElement("p",null,e.text))})):r.a.createElement("div",null,"Loading...")};var q=function(){var e=Object(n.useContext)(h).firebase,t=Object(n.useState)([]),a=Object(m.a)(t,2),c=a[0],o=a[1],s=Object(n.useState)([]),l=Object(m.a)(s,2),i=l[0],d=l[1],p=Object(n.useState)(""),f=Object(m.a)(p,2),b=f[0],v=f[1];return Object(n.useEffect)(function(){e.db.collection("links").get().then(function(e){var t=e.docs.map(function(e){return Object(u.a)({id:e.id},e.data())});d(t)})},[]),r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var t=b.toLowerCase(),a=i.filter(function(e){return e.description.toLowerCase().includes(t)||e.url.toLowerCase().includes(t)||e.postedBy.name.toLowerCase().includes(t)});console.log(a),o(a)}},r.a.createElement("div",null,"search ",r.a.createElement("input",{type:"text",onChange:function(e){return v(e.target.value)}}),r.a.createElement("button",null,"OK"))),c.map(function(e,t){return r.a.createElement(A,{key:e.id,link:e,showCount:!1,index:t})}))};function F(e){var t={};return e.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(e.email)||(t.email="Invalid email address"):t.email="Email required",e.password?e.password.length<6&&(t.password="Password must be at least 6 characters"):t.password="Password required",t}var R={name:"",email:"",password:""};var U=function(e){var t=d(R,F,function(){var t=Object(y.a)(j.a.mark(function t(){var a,n,r;return j.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=l.email,n=l.password,r=l.name,t.prev=1,!f){t.next=7;break}return t.next=5,B.login(a,n);case 5:t.next=9;break;case 7:return t.next=9,B.register(r,a,n);case 9:e.history.push("/"),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(1),console.error("Authentication error",t.t0),w(t.t0.message);case 16:case"end":return t.stop()}},t,null,[[1,12]])}));return function(){return t.apply(this,arguments)}}()),a=t.handleChange,c=t.handleSubmit,o=t.handleBlur,l=t.values,i=t.errors,u=t.isSubmitting,p=Object(n.useState)(!0),h=Object(m.a)(p,2),f=h[0],b=h[1],v=Object(n.useState)(null),E=Object(m.a)(v,2),g=E[0],w=E[1];return r.a.createElement("div",null,r.a.createElement("h2",{className:"mv3"},f?"Login":"Create Account"),r.a.createElement("form",{onSubmit:c,className:"flex flex-column",autoComplete:"nope"},!f&&r.a.createElement("input",{onChange:a,value:l.name,name:"name",type:"text",placeholder:"Your name",autoComplete:"nope"}),r.a.createElement("input",{onChange:a,value:l.email,onBlur:o,name:"email",type:"email",className:i.email&&"error-input",placeholder:"Your email",autoComplete:"nope"}),i.email&&r.a.createElement("p",{className:"error-text"},i.email),r.a.createElement("input",{onChange:a,value:l.password,onBlur:o,name:"password",type:"password",className:i.password&&"error-input",autoComplete:"new-password",placeholder:"Choose a secure password"}),i.password&&r.a.createElement("p",{className:"error-text"},i.password),g&&r.a.createElement("p",{className:"error-text"},g),r.a.createElement("div",{className:"flex mt3"},r.a.createElement("button",{disabled:u,type:"submit",className:"button pointer  mr2",style:{background:u?"gray":"orange"}},"Submit"),r.a.createElement("button",{type:"button",className:"pointer button",onClick:function(){return b(function(e){return!e})}},f?"need to create an account?":"already have an acount?"))),r.a.createElement("div",{className:"forgot-password"},r.a.createElement(s.b,{to:"/forgot"},"Forgot password?")))};var W=function(){var e=Object(n.useContext)(h).firebase,t=Object(n.useState)(""),a=Object(m.a)(t,2),c=a[0],o=a[1],s=Object(n.useState)(!1),l=Object(m.a)(s,2),i=l[0],u=l[1],d=Object(n.useState)(null),p=Object(m.a)(d,2),f=p[0],b=p[1],v=function(){var t=Object(y.a)(j.a.mark(function t(){return j.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.resetPassword(c);case 3:u(!0),b(null),t.next=12;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Error sending email",t.t0),b(t.t0.message),u(!1);case 12:case"end":return t.stop()}},t,null,[[0,7]])}));return function(){return t.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement("input",{type:"email",className:"input",placeholder:"Provide your account email",onChange:function(e){return o(e.target.value)}}),r.a.createElement("div",null,r.a.createElement("button",{className:"button",onClick:v},"Reset password")),i&&r.a.createElement("p",null,"Check email to reset password"),f&&r.a.createElement("p",{className:"error-text"},f))};var Y=Object(l.g)(function(){var e=Object(n.useContext)(h),t=e.user,a=e.firebase;return r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"flex"},r.a.createElement("img",{src:"/logo.png",alt:"Hooks news logo",className:"logo"}),r.a.createElement(s.c,{to:"/",className:"header-title"},"V-Newz"),r.a.createElement(s.c,{to:"/",className:"header-link"},"new"),r.a.createElement("div",{className:"divider"},"|"),r.a.createElement(s.c,{to:"/top",className:"header-link"},"top"),r.a.createElement("div",{className:"divider"},"|"),r.a.createElement(s.c,{to:"/search",className:"header-link"},"search"),t&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"divider"},"|"),r.a.createElement(s.c,{to:"/create",className:"header-link"},"submit"))),r.a.createElement("div",{className:"flex"},t?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"header-name"},t.displayName," |"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"header-button",onClick:function(){return a.logout()}},"logout")):r.a.createElement(s.c,{to:"/login",className:"header-link"},"login")))}),z=function(){var e=Object(n.useState)(null),t=Object(m.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)(function(){var e=B.auth.onAuthStateChanged(function(e){r(e||null)});return function(){return e()}},[]),a},J=function(){var e=z();return r.a.createElement(s.a,null,r.a.createElement(h.Provider,{value:{user:e,firebase:B}},r.a.createElement("div",{className:"app-container"},r.a.createElement(Y,null),r.a.createElement("div",{className:"route-container"},r.a.createElement(l.d,null,r.a.createElement(l.b,{exact:!0,path:"/",render:function(){return r.a.createElement(l.a,{to:"/new/1"})}}),r.a.createElement(l.b,{path:"/create",component:b}),r.a.createElement(l.b,{path:"/login",component:U}),r.a.createElement(l.b,{path:"/forgot",component:W}),r.a.createElement(l.b,{path:"/search",component:q}),r.a.createElement(l.b,{path:"/top",component:D}),r.a.createElement(l.b,{path:"/new/:page",component:D}),r.a.createElement(l.b,{path:"/link/:linkId",component:L}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(J,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[41,1,2]]]);
//# sourceMappingURL=main.25e63d13.chunk.js.map